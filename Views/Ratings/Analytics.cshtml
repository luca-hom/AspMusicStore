@model IEnumerable<AspMusicStore.Models.Rating>
@{
    ViewData["Title"] = "Ratings Analytics";
}

<h1>Ratings Analytics</h1>
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@

@foreach(var item in Model)
{
    @Html.DisplayFor(modelItem => item.Track.TrackTitle);
    <text> = </text>
    @Html.DisplayFor(modelItem => item.RatingValue);
    <br />
}



<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {packages: ['corechart', 'bar']});
    google.charts.setOnLoadCallback(drawBasic);

    function drawBasic() {

          var data = google.visualization.arrayToDataTable([
            ['Tracks', 'Rating',],
              @foreach (var item in Model.DistinctBy(x => x.TrackID))
                {
                    <text>
                        ['@item.Track.TrackTitle', @item.Track.TrackRating],
                    </text>
                }
    
          ]);

          var options = {
            title: 'Best Tracks',
            chartArea: {width: '50%'},
            hAxis: {
              title: 'Total Rating',
              minValue: 0
            },
            vAxis: {
              title: 'Track'
            }
          };

          var chart = new google.visualization.BarChart(document.getElementById('chart_div'));

          chart.draw(data, options);
        }

</script>


<div class="row">
    <div class="col-lg-12">
        <div id="chart_div" style="width:600px;heightL350px"></div>
    </div>
</div>